<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explicación Detallada de la Clase Menu (POO PHP)</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; background-color: #f4f4f4; color: #333; }
        .container { max-width: 900px; margin: auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1, h2, h3 { color: #0056b3; }
        pre { background: #e9e9e9; padding: 15px; border-radius: 5px; overflow-x: auto; }
        code { font-family: "Courier New", Courier, monospace; background: #e9e9e9; padding: 2px 4px; border-radius: 3px; }
        .method-section { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .method-section:last-child { border-bottom: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Explicación Detallada de la Clase <code>Menu</code> (POO PHP)</h1>
        <p>Esta documentación explica la implementación de una clase <code>Menu</code> en PHP, diseñada para aplicaciones de línea de comandos (CLI). El objetivo es proporcionar una interfaz de usuario sencilla y modular para interactuar con la aplicación, siguiendo principios básicos de la Programación Orientada a Objetos (POO).</p>

        <h2>Concepto General</h2>
        <p>La clase <code>Menu</code> encapsula toda la lógica necesaria para mostrar opciones al usuario, capturar su selección y ejecutar una acción predefinida. Esto permite que el código principal de la aplicación se mantenga limpio y se enfoque en la lógica de negocio, delegando la interacción con el usuario al objeto <code>Menu</code>.</p>

        <h2>Estructura de la Clase <code>Menu</code></h2>
        <pre><code>&lt;?php

class Menu {
    private $titulo;
    private $opciones;

    // ... métodos ...
}

?&gt;</code></pre>

        <h3>Propiedades (Atributos)</h3>
        <ul>
            <li><strong><code>private $titulo;</code></strong>: Una cadena de texto que almacena el título principal del menú (ej., "Menú Principal de Inventario"). Es <code>private</code> para que solo los métodos de la propia clase puedan acceder o modificarlo directamente, promoviendo el encapsulamiento.</li>
            <li><strong><code>private $opciones;</code></strong>: Un array asociativo donde la clave es el número de la opción (ej., <code>1</code>, <code>2</code>, <code>3</code>) y el valor es <strong>otro array asociativo</strong> con dos claves:
                <ul>
                    <li><code>'descripcion'</code>: Una cadena de texto que describe la opción (ej., "Añadir Repuesto").</li>
                    <li><code>'accion'</code>: Un "callable" (una función anónima o un array <code>[$objeto, 'nombreMetodo']</code>) que se ejecutará cuando el usuario seleccione esta opción.</li>
                </ul>
                Es <code>private</code> por las mismas razones de encapsulamiento.
            </li>
        </ul>

        <h2>Métodos (Comportamientos)</h2>

        <div class="method-section">
            <h3><code>__construct($titulo, array $opciones)</code></h3>
            <p>Este es el <strong>constructor</strong> de la clase. Se ejecuta automáticamente cada vez que se crea una nueva instancia (objeto) de <code>Menu</code>.</p>
            <ul>
                <li><strong>Propósito:</strong> Inicializar las propiedades <code>$titulo</code> y <code>$opciones</code> del objeto <code>Menu</code> con los valores proporcionados al momento de su creación.</li>
                <li><strong>Parámetros:</strong>
                    <ul>
                        <li><code>$titulo</code>: La cadena de texto que será el título del menú.</li>
                        <li><code>array $opciones</code>: Un array asociativo con las opciones del menú, siguiendo la estructura <code>[numero =&gt; ['descripcion' =&gt; '...', 'accion' =&gt; callable]]</code>.</li>
                    </ul>
                </li>
                <li><strong>Funcionamiento:</strong> Asigna los valores de los parámetros a las propiedades internas <code>$this->titulo</code> y <code>$this->opciones</code>.</li>
            </ul>
            <pre><code>public function __construct($titulo, array $opciones) {
    $this->titulo = $titulo;
    $this->opciones = $opciones;
}</code></pre>
        </div>

        <div class="method-section">
            <h3><code>mostrar()</code></h3>
            <p>Este método se encarga de presentar visualmente el menú al usuario en la consola.</p>
            <ul>
                <li><strong>Propósito:</strong> Imprimir el título del menú y cada una de las opciones numeradas con su descripción.</li>
                <li><strong>Funcionamiento:</strong>
                    <ol>
                        <li>Imprime el <code>$titulo</code> del menú, enmarcado para una mejor visibilidad.</li>
                        <li>Recorre el array <code>$opciones</code> usando un bucle <code>foreach</code>.</li>
                        <li>Para cada opción, imprime su número (clave) y su <code>'descripcion'</code> (valor del sub-array) en una nueva línea.</li>
                        <li>Añade un separador al final para mejorar la legibilidad.</li>
                    </ol>
                </li>
            </ul>
            <pre><code>public function mostrar() {
    echo PHP_EOL . "--------------------------------------" . PHP_EOL;
    echo " --- " . $this->titulo . " ---
";
    foreach ($this->opciones as $numero =&gt; $opcion) {
        echo $numero . " . " . $opcion['descripcion'] . PHP_EOL;
    }
    echo "--------------------------------------" . PHP_EOL;
}</code></pre>
        </div>

        <div class="method-section">
            <h3><code>obtenerSeleccion()</code></h3>
            <p>Este método interactúa con el usuario para obtener su elección.</p>
            <ul>
                <li><strong>Propósito:</strong> Solicitar al usuario que ingrese su opción y capturar esa entrada desde la consola.</li>
                <li><strong>Funcionamiento:</strong>
                    <ol>
                        <li>Imprime un mensaje pidiendo al usuario que ingrese su opción.</li>
                        <li>Utiliza <code>fgets(STDIN)</code> para leer la línea completa que el usuario escribe. <code>STDIN</code> representa la entrada estándar (el teclado).</li>
                        <li>Utiliza <code>trim()</code> para eliminar cualquier espacio en blanco o salto de línea extra que <code>fgets()</code> pueda haber capturado, asegurando una entrada limpia.</li>
                        <li>Devuelve la entrada limpia del usuario.</li>
                    </ol>
                </li>
            </ul>
            <pre><code>public function obtenerSeleccion() {
    echo "Ingrese su opción: ";
    $seleccion = trim(fgets(STDIN));
    return $seleccion;
}</code></pre>
        </div>

        <div class="method-section">
            <h3><code>ejecutarOpcion($seleccion)</code></h3>
            <p>Este método procesa la opción elegida por el usuario y ejecuta la acción asociada.</p>
            <ul>
                <li><strong>Propósito:</strong> Tomar la selección del usuario, verificar su validez y ejecutar el "callable" (función o método) asociado a esa opción.</li>
                <li><strong>Parámetros:</strong>
                    <ul>
                        <li><code>$seleccion</code>: La opción (número) ingresada por el usuario.</li>
                    </ul>
                </li>
                <li><strong>Funcionamiento:</strong>
                    <ol>
                        <li>Verifica si la <code>$seleccion</code> existe como una clave válida en el array <code>$opciones</code> usando <code>array_key_exists()</code>.</li>
                        <li>Si la opción es válida:
                            <ul>
                                <li>Obtiene el sub-array de la opción seleccionada, que contiene la <code>'descripcion'</code> y la <code>'accion'</code>.</li>
                                <li>Imprime un mensaje confirmando la selección.</li>
                                <li>Verifica si la <code>'accion'</code> es un "callable" (una función o un método ejecutable) usando <code>is_callable()</code>.</li>
                                <li>Si es un callable, lo ejecuta usando <code>call_user_func($accion)</code>.</li>
                                <li>Si la acción no es ejecutable, imprime un mensaje de error.</li>
                                <li>Si la <code>'descripcion'</code> de la opción es "Salir", devuelve <code>false</code> para indicar que el bucle principal del menú debe terminar.</li>
                            </ul>
                        </li>
                        <li>Si la opción no es válida, imprime un mensaje de error.</li>
                        <li>En cualquier otro caso (opción válida pero no "Salir"), devuelve <code>true</code> para indicar que el menú debe continuar.</li>
                    </ol>
                </li>
            </ul>
            <pre><code>public function ejecutarOpcion($seleccion) {
    if (array_key_exists($seleccion, $this->opciones)) {
        $opcionSeleccionada = $this->opciones[$seleccion];
        $descripcion = $opcionSeleccionada['descripcion'];
        $accion = $opcionSeleccionada['accion'];

        echo "Ha seleccionado: " . $descripcion . PHP_EOL;

        if (is_callable($accion)) {
            call_user_func($accion);
        } else {
            echo "La acción para '" . $descripcion . "' no es ejecutable.\n";
        }

        if ($descripcion === 'Salir') {
            return false;
        }
    } else {
        echo "Opción inválida. Por favor, intente de nuevo.\n";
    }
    return true;
}</code></pre>
        </div>

        <div class="method-section">
            <h3><code>iniciar()</code></h3>
            <p>Este es el método principal que orquesta el funcionamiento del menú.</p>
            <ul>
                <li><strong>Propósito:</strong> Ejecutar el ciclo completo del menú (mostrar, obtener selección, ejecutar acción) de forma repetida hasta que el usuario decida salir.</li>
                <li><strong>Funcionamiento:</strong>
                    <ol>
                        <li>Inicializa una variable booleana <code>$continuarMenu</code> a <code>true</code>.</li>
                        <li>Entra en un bucle <code>do-while</code>, lo que asegura que el menú se muestre al menos una vez.</li>
                        <li>Dentro del bucle:
                            <ul>
                                <li>Llama a <code>$this->mostrar()</code> para imprimir el menú.</li>
                                <li>Llama a <code>$this->obtenerSeleccion()</code> para capturar la entrada del usuario.</li>
                                <li>Llama a <code>$this->ejecutarOpcion($seleccion)</code>. El valor de retorno de este método (<code>true</code> o <code>false</code>) se asigna a <code>$continuarMenu</code>.</li>
                            </ul>
                        </li>
                        <li>El bucle <code>while ($continuarMenu)</code> continúa mientras <code>$continuarMenu</code> sea <code>true</code>. Cuando <code>ejecutarOpcion()</code> devuelve <code>false</code> (porque el usuario eligió "Salir"), el bucle termina.</li>
                        <li>Finalmente, imprime un mensaje de despedida.</li>
                    </ol>
                </li>
            </ul>
            <pre><code>public function iniciar() {
    $continuarMenu = true;

    do {
        $this->mostrar();
        $seleccion = $this->obtenerSeleccion();
        $continuarMenu = $this->ejecutarOpcion($seleccion);
    } while ($continuarMenu);

    echo "Saliendo del menú...\n";
}</code></pre>
        </div>

        <h2>Ejemplo de Uso (en <code>Main.php</code>)</h2>
        <p>Para utilizar esta clase <code>Menu</code>, en tu archivo principal (ahora <code>Main.php</code>), necesitarías:</p>
        <ol>
            <li>Incluir el archivo <code>Menu.php</code>.</li>
            <li>Definir las opciones de tu menú en un array asociativo, donde cada opción es un sub-array con <code>'descripcion'</code> y <code>'accion'</code> (un callable).</li>
            <li>Crear una instancia de la clase <code>Menu</code>, pasándole el título y las opciones.</li>
            <li>Llamar al método <code>iniciar()</code> de tu objeto <code>Menu</code>.</li>
        </ol>
        <pre><code>&lt;?php
// Incluir la definición de la clase Menu
require_once 'Menu.php';

// Definir las opciones del menú principal
$opcionesMenuPrincipal = [
    1 =&gt; ['descripcion' =&gt; 'Añadir Repuesto', 'accion' =&gt; function() { echo "Acción de añadir repuesto."; }],
    2 =&gt; ['descripcion' =&gt; 'Listar Repuestos', 'accion' =&gt; function() { echo "Acción de listar repuestos."; }],
    3 =&gt; ['descripcion' =&gt; 'Salir', 'accion' =&gt; function() { echo "Saliendo..."; }]
];

// Crear una instancia del menú
$menuPrincipal = new Menu("Menú Principal de Inventario", $opcionesMenuPrincipal);

// Iniciar el menú
$menuPrincipal->iniciar();

echo "¡Aplicación finalizada!\n";
?&gt;</code></pre>
    </div>
</body>
</html>